webpackJsonp([6],{L133:function(e,t){},yC0Y:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("HzJ8"),s=n.n(r),c=n("4YfN"),i=n.n(c),a=n("0eBz"),o=n("0DTB"),d=(n("sqAx"),n("NxGh"),n("IcnI"),n("yl8L")),v=n("SJI6"),p=n("fdFc"),u=n("EKaR"),f={name:"CopyDetails",components:{HeaderTop:a.a,FooterBottom:o.a,VanFieldSelectPicker:d.a},data:function(){return{oneEnergyMsg:"",departmentId:"",departmentNo:""}},mounted:function(){var e=this;Object(p.b)()||(pushHistory(),this.gotoURL(function(){4==e.deviceServiceMsg.state?e.changeIsFreshDeviceServicePage(!1):e.changeIsFreshDeviceServicePage(!0),e.$router.push({path:"deviceService"}),e.changeTitleTxt({tit:"设备巡检"}),Object(p.k)("currentTitle","设备巡检")}));var t=this;window.scanQRcodeCallback=function(e){t.scanQRcodeCallback(e)},this.getqueryOneEnergyTask()},watch:{},computed:i()({},Object(v.mapGetters)(["navTopTitle","deviceServiceMsg","userInfo","isCurrentDeviceCopyServiceVerifySweepCode","completeDeviceEnergyRecordServiceOfficeInfo","energyRecordList"]),{userName:function(){return this.userInfo.userName},userTypeId:function(){return this.userInfo.extendData.user_type_id},proId:function(){return this.userInfo.extendData.proId},proName:function(){return this.userInfo.extendData.proName},workerId:function(){return this.userInfo.extendData.userId},name:function(){return this.userInfo.name},taskId:function(){return this.deviceServiceMsg.taskId}}),methods:i()({},Object(v.mapMutations)(["changeTitleTxt","changeIsFreshDeviceServicePage","changeIsCurrentDeviceCopyServiceVerifySweepCode","changeCurrentDeviceCopyVerifySweepCodeDepNumber","changeEnergyRecordList","changeCompleteDeviceEnergyRecordServiceOfficeInfo"]),{getqueryOneEnergyTask:function(){var e=this;Object(u.q)(this.taskId).then(function(t){if(t&&200==t.data.code){var n=t.data.data;n.spaces=JSON.parse(t.data.data.spaces);var r=!0,c=!1,i=void 0;try{for(var a,o=s()(n.spaces);!(r=(a=o.next()).done);r=!0){a.value.checked=!1}}catch(e){c=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(c)throw i}}if(e.oneEnergyMsg=n,e.completeDeviceEnergyRecordServiceOfficeInfo.length>0)for(var d=0,v=e.completeDeviceEnergyRecordServiceOfficeInfo.length;d<v;d++)if(e.oneEnergyMsg.id==e.completeDeviceEnergyRecordServiceOfficeInfo[d].taskId&&e.completeDeviceEnergyRecordServiceOfficeInfo[d].officeList.length>0)for(var p=0,u=e.completeDeviceEnergyRecordServiceOfficeInfo[d].officeList.length;p<u;p++)if(e.oneEnergyMsg.spaces.length>0)for(var f=0,l=e.oneEnergyMsg.spaces.length;f<l;f++)e.oneEnergyMsg.spaces[f].depNo==e.completeDeviceEnergyRecordServiceOfficeInfo[d].officeList[p]&&(e.oneEnergyMsg.spaces[f].checked=!0)}}).catch(function(t){e.$dialog.alert({message:""+t.message,closeOnPopstate:!0}).then(function(){})})},juddgeCurrentDepartment:function(e){var t=this;Object(u.G)(e).then(function(n){n&&200==n.data.code?(t.storeCurrentDepartmentNumber(e.depId),t.changeCurrentDeviceCopyVerifySweepCodeDepNumber(e.depNo),Object(p.k)("energyDepartmentService",e.depNo),t.$router.push({path:"copyRecordBill"}),t.changeTitleTxt({tit:"设备参数单"}),Object(p.k)("currentTitle","设备参数单")):t.$toast(""+n.data.msg)}).catch(function(e){t.$dialog.alert({message:""+e,closeOnPopstate:!0}).then(function(){})})},scanQRcodeCallback:function(e){var t=this;if(e)try{var n=e.split("|");n.length>0&&(this.departmentId=n[0],this.departmentNo=n[1],this.juddgeCurrentDepartment({proId:this.proId,id:this.taskId,depNo:this.departmentNo,depId:this.departmentId,workerId:this.workerId}))}catch(e){this.$dialog.alert({message:""+e}).then(function(){t.fillConsumable()})}else this.$dialog.alert({message:"当前没有扫描到任何信息,请重新扫描"}).then(function(){t.fillConsumable()})},storeCurrentDepartmentNumber:function(e){var t=this,n=[];if((n=Object(p.e)(this.isCurrentDeviceCopyServiceVerifySweepCode)).length>0){var r=this.isCurrentDeviceCopyServiceVerifySweepCode.indexOf(this.isCurrentDeviceCopyServiceVerifySweepCode.filter(function(e){return e.taskId==t.taskId})[0]);-1!=r?n[r].number=e:n.push({number:e,taskId:this.taskId})}else n.push({number:e,taskId:this.taskId});this.changeIsCurrentDeviceCopyServiceVerifySweepCode(n),Object(p.k)("isCurrentDeviceCopyServiceVerifySweepCode",{number:n})},backTo:function(){4==this.deviceServiceMsg.state?this.changeIsFreshDeviceServicePage(!1):this.changeIsFreshDeviceServicePage(!0),this.$router.push({path:"deviceService"}),this.changeTitleTxt({tit:"设备巡检"}),Object(p.k)("currentTitle","设备巡检")},fillConsumable:function(){window.android.scanQRcode()},clearEnergyData:function(){var e=this,t=this.energyRecordList.filter(function(t){return t.taskId!==e.taskId});this.changeEnergyRecordList(t),Object(p.k)("energyRecordList",{energyRecord:t})},clearCompleteEnergyRecordDepartmentInfo:function(){var e=this,t=this.completeDeviceEnergyRecordServiceOfficeInfo.filter(function(t){return t.taskId!==e.taskId});this.changeCompleteDeviceEnergyRecordServiceOfficeInfo(t),Object(p.k)("isCompleteDeviceEnergyRecordServiceOfficeInfo",{sweepCodeInfo:t})},clearCurrentDepartmentNumber:function(){var e=this,t=this.isCurrentDeviceCopyServiceVerifySweepCode.filter(function(t){return t.taskId!==e.taskId});this.changeIsCurrentDeviceCopyServiceVerifySweepCode(t),Object(p.k)("isCurrentDeviceCopyServiceVerifySweepCode",{number:t})},completeTask:function(){var e=this;Object(u.b)(this.proId,this.taskId).then(function(t){t&&200==t.data.code?(e.$toast(""+t.data.msg),e.clearEnergyData(),e.clearCompleteEnergyRecordDepartmentInfo(),e.clearCurrentDepartmentNumber(),e.backTo()):e.$dialog.alert({message:""+t.data.msg,closeOnPopstate:!0}).then(function(){})}).catch(function(t){e.$dialog.alert({message:""+t.message,closeOnPopstate:!0}).then(function(){})})}})},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-wrapper"},[n("div",{staticClass:"worker-show"},[n("HeaderTop",{attrs:{title:e.navTopTitle}},[n("van-icon",{attrs:{slot:"left",name:"arrow-left"},on:{click:e.backTo},slot:"left"})],1),e._v(" "),n("div",{staticClass:"content-top"},[n("p",{staticClass:"content-top-other"},[n("span",[e._v("巡检编号")]),e._v(" "),n("span",[e._v("\n         "+e._s(e.oneEnergyMsg.taskNumber)+"\n        ")])]),e._v(" "),n("p",{staticClass:"content-top-other"},[n("span",[e._v("巡检名称")]),e._v(" "),n("span",[e._v("\n           "+e._s(e.oneEnergyMsg.taskName)+"\n        ")])]),e._v(" "),n("p",{staticClass:"content-top-other"},[n("span",[e._v("当前次数")]),e._v(" "),n("span",[e._v("\n          "+e._s(e.oneEnergyMsg.currentTimes)+"\n        ")])]),e._v(" "),n("p",{staticClass:"content-top-other"},[n("span",[e._v("时间")]),e._v(" "),n("span",[e._v("\n          "+e._s(e.oneEnergyMsg.startTime)+"\n        ")])])]),e._v(" "),n("div",{staticClass:"content-middle"},[n("p",[e._v("巡检科室")]),e._v(" "),n("ul",{directives:[{name:"show",rawName:"v-show",value:!!e.oneEnergyMsg.spaces&&e.oneEnergyMsg.spaces.length>0,expression:"oneEnergyMsg.spaces ? oneEnergyMsg.spaces.length > 0 : false"}]},e._l(e.oneEnergyMsg.spaces,function(t,r){return n("li",{key:t+"-"+r,class:{listStyle:t.checked}},[e._v(e._s(t.depName))])}),0)]),e._v(" "),n("div",{staticClass:"content-bottom"},[n("p",{directives:[{name:"show",rawName:"v-show",value:4!=e.deviceServiceMsg.state,expression:"deviceServiceMsg.state != 4"}],staticClass:"back-home",on:{click:e.fillConsumable}},[e._v("扫一扫")]),e._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:4!=e.deviceServiceMsg.state,expression:"deviceServiceMsg.state != 4"}],staticClass:"quit-account",on:{click:e.completeTask}},[e._v("完成抄录")])])],1)])},staticRenderFns:[]};var h=n("C7Lr")(f,l,!1,function(e){n("L133")},"data-v-e9430bae",null);t.default=h.exports}});